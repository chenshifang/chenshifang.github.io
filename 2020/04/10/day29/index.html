<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="author" content="陈士方">





<title>Day29 | 陈士方的博客</title>



    <link rel="icon" href="/favicon.ico">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    



    <!-- scripts list from _config.yml -->
    
    <script src="/js/script.js"></script>
    
    <script src="/js/tocbot.min.js"></script>
    



    
    
        
    


	
<meta name="generator" content="Hexo 4.2.0"></head>


<body>
    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo">
				<a href="/">
				陈士方的博客
				</a>
			</div>
			
			
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/archives">目录</a>
                
                    <a class="menu-item" href="/category">分类</a>
                
                    <a class="menu-item" href="/tag">标签</a>
                
                    <a class="menu-item" href="http://chenshifang.gitee.io/chen_resume/" target="_blank" rel="noopener">关于</a>
                
                <input id="switch_default" type="checkbox" class="switch_default">
                <label for="switch_default" class="toggleBtn"></label>
            </div>

        </div>
    </nav>

    
    <nav class="navbar-mobile" id="nav-mobile">
        <div class="container">
            <div class="navbar-header">
                <div>
                    <a href="/">陈士方的博客</a><a id="mobile-toggle-theme">·&nbsp;Light</a>
                </div>
                <div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div>
            </div>
            <div class="menu" id="mobile-menu">
                
                    <a class="menu-item" href="/archives">目录</a>
                
                    <a class="menu-item" href="/category">分类</a>
                
                    <a class="menu-item" href="/tag">标签</a>
                
                    <a class="menu-item" href="http://chenshifang.gitee.io/chen_resume/" target="_blank" rel="noopener">关于</a>
                
            </div>
        </div>
    </nav>

</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if(toggleMenu.classList.contains("active")){
           toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        }else{
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>
        <div class="main">
            <div class="container">
    
    
        <div class="post-toc">
    <div class="tocbot-list">
    </div>
    <div class="tocbot-list-menu">
        <a class="tocbot-toc-expand" onclick="expand_toc()">Expand all</a>
        <a onclick="go_top()">Back to top</a>
        <a onclick="go_bottom()">Go to bottom</a>
    </div>
</div>

<script>
    document.ready(
        function () {
            tocbot.init({
                tocSelector: '.tocbot-list',
                contentSelector: '.post-content',
                headingSelector: 'h1, h2, h3, h4, h5',
                collapseDepth: 1,
                orderedList: false,
                scrollSmooth: true,
            })
        }
    )

    function expand_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 6,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "collapse_toc()");
        b.innerHTML = "Collapse all"
    }

    function collapse_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 1,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "expand_toc()");
        b.innerHTML = "Expand all"
    }

    function go_top() {
        window.scrollTo(0, 0);
    }

    function go_bottom() {
        window.scrollTo(0, document.body.scrollHeight);
    }

</script>
    

    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">Day29</h1>
            
                <div class="post-meta">
                    
                        Author: <a itemprop="author" rel="author" href="/">陈士方</a>
                    

                    
                        <span class="post-time">
                        Date: <a href="#">四月 10, 2020&nbsp;&nbsp;0:00:00</a>
                        </span>
                    
                    
                        <span class="post-category">
                    Category:
                            
                                <a href="/categories/%E7%AC%94%E8%AE%B0/">笔记</a>
                            
                        </span>
                    
                </div>
            
        </header>

        <div class="post-content">
            <h4 id="InnoDB事务原理"><a href="#InnoDB事务原理" class="headerlink" title="InnoDB事务原理"></a>InnoDB事务原理</h4><p>1，事务是数据库区别文件系统的重要特性之一，事务会把数据库从一种一致性状态转换为另一种一致性状态。<br>2，在数据库提交时，可以确保所有修改都已保存或者都不保存。</p>
<h4 id="事务四大特性"><a href="#事务四大特性" class="headerlink" title="事务四大特性"></a>事务四大特性</h4><ol>
<li>原子性(Atomicity)：整个事物的所有操作要么全部提交成功，要么全部失败回滚(不会出现部分执行的情况)。</li>
<li>一致性(Consistency)：几个并行执行的事务，其执行结果必须与按某一顺序串行执行的结果相一致。</li>
<li>隔离性(Isolation)：事务的执行不受其他事务的干扰，事务执行的中间结果对其他事务必须是透明的。</li>
<li>持久性(Durability):  一个事务一旦被提交了，那么对数据库中的数据的改变就是永久性的，即便是在数据库系统遇到故障的情况下也不会丢失提交事务的操作</li>
</ol>
<h4 id="MySQL中锁的分类"><a href="#MySQL中锁的分类" class="headerlink" title="MySQL中锁的分类"></a>MySQL中锁的分类</h4><ol>
<li>按操作划分：DML锁，DDL锁</li>
<li>按锁的粒度划分：表级锁、行级锁、页级锁</li>
<li>按锁级别划分：共享锁、排他锁</li>
<li>按加锁方式划分：自动锁、显示锁</li>
<li>按使用方式划分：乐观锁、悲观锁</li>
</ol>
<ul>
<li>乐观锁</li>
</ul>
<ol>
<li>每次获取商品时，不对该商品加锁。</li>
<li>在更新数据的时候需要比较程序中的库存量与数据库中的库存量是否相等，如果相等则进行更新</li>
<li>反之程序重新获取库存量，再次进行比较，直到两个库存量的数值相等才进行数据更新</li>
</ol>
<ul>
<li>悲观锁</li>
</ul>
<ol>
<li>每次获取商品时，对该商品加排他锁。</li>
<li>也就是在用户A获取获取 id=1 的商品信息时对该行记录加锁，期间其他用户阻塞等待访问该记录。</li>
</ol>
<ul>
<li>排它锁</li>
</ul>
<ol>
<li>排它锁又叫写锁，如果事务T对A加上排它锁，则其它事务都不能对A加任何类型的锁。获准排它锁的事务既能读数据，又能写数据。</li>
<li>用法 ：  SELECT … FOR UPDATE</li>
</ol>
<ul>
<li>共享锁</li>
</ul>
<ol>
<li>共享锁又叫读锁，如果事务T对A加上共享锁，则其它事务只能对A再加共享锁，不能加其它锁。</li>
<li>获准共享锁的事务只能读数据，不能写数据。</li>
<li>用法： SELECT … LOCK IN SHARE MODE;</li>
</ol>
<h4 id="MySQL的优化"><a href="#MySQL的优化" class="headerlink" title="MySQL的优化"></a>MySQL的优化</h4><ol>
<li>字段设计优化    适应遵循数据库三范式</li>
<li>引擎的选择      适应选择MyIsam &amp; InnoDB</li>
<li>索引            索引也会消耗内存空间，并不是越多越好。而且索引的种类都有各自的有点</li>
<li>查询缓存        将 select查询结果缓存起来，key 为SQL语句，value 为查询结果</li>
<li>分区</li>
<li>水平分割和垂直分割</li>
<li>集群            </li>
<li>SQL语句</li>
<li>服务器的选择     选择配置较高的服务器</li>
</ol>
<h4 id="为什么优化MySQL"><a href="#为什么优化MySQL" class="headerlink" title="为什么优化MySQL"></a>为什么优化MySQL</h4><p>•    系统的吞吐量瓶颈往往出现在数据库的访问速度上<br>•    随着应用程序的运行，数据库的中的数据会越来越多，处理时间会相应变慢<br>•    为了避免慢查询的出现</p>
<h4 id="MySQL主从同步原理"><a href="#MySQL主从同步原理" class="headerlink" title="MySQL主从同步原理"></a>MySQL主从同步原理</h4><ol>
<li><p>master服务器将数据的改变记录二进制binlog日志，当master上的数据发生改变时，则将其改变写入二进制日志中；</p>
</li>
<li><p>slave服务器会在一定时间间隔内对master二进制日志进行探测其是否发生改变，如果发生改变，则开始一个I/OThread请求master二进制事件</p>
</li>
<li><p>同时主节点为每个I/O线程启动一个dump线程，用于向其发送二进制事件，并保存至从节点本地的中继日志中，从节点将启动SQL线程从中继日志中读取二进制日志，在本地重放，使得其数据和主节点的保持一致，最后I/OThread和SQLThread将进入睡眠状态，等待下一次被唤醒</p>
</li>
</ol>
<h4 id="MySQL慢查询"><a href="#MySQL慢查询" class="headerlink" title="MySQL慢查询"></a>MySQL慢查询</h4><p>MySQL的慢查询，全名是慢查询日志，是MySQL提供的一种日志记录，用来记录在MySQL中响应时间超过阀值的语句。具体环境中，运行时间超过long_query_time值的SQL语句，则会被记录到慢查询日志中。long_query_time的默认值为10，意思是记录运行10秒以上的语句。默认情况下，MySQL数据库并不启动慢查询日志，需要手动来设置这个参数。<br>    当然，如果不是调优需要的话，一般不建议启动该参数，因为开启慢查询日志会或多或少带来一定的性能影响。<br>    此外，慢查询日志支持将日志记录写入文件和数据库表</p>
<h4 id="MySQL-慢查询的相关参数解释："><a href="#MySQL-慢查询的相关参数解释：" class="headerlink" title="MySQL 慢查询的相关参数解释："></a>MySQL 慢查询的相关参数解释：</h4><p>slow_query_log：是否开启慢查询日志，1表示开启，0表示关闭。<br>log-slow-queries ：旧版（5.6以下版本）MySQL数据库慢查询日志存储路径。可以不设置该参数，系统则会默认给一个缺省的文件host_name-slow.log<br>slow-query-log-file：新版（5.6及以上版本）MySQL数据库慢查询日志存储路径。可以不设置该参数，系统则会默认给一个缺省的文件host_name-slow.log<br>long_query_time：慢查询阈值，当查询时间多于设定的阈值时，记录日志。<br>log_queries_not_using_indexes：未使用索引的查询也被记录到慢查询日志中（可选项）。<br>log_output：日志存储方式。log_output=’FILE’表示将日志存入文件，默认值是’FILE’。log_output=’TABLE’表示将日志存入数据库。</p>
<h4 id="数据结构"><a href="#数据结构" class="headerlink" title="数据结构"></a>数据结构</h4><ol>
<li>栈<br> 栈的定义：栈是一种数据集合，可以理解为只能在一端进行插入或删除操作的列表<br> 栈的特点：后进先出（last-in, first-out）</li>
</ol>
<ol start="2">
<li>队列定义<br> 1、队列是一个数据集合，仅允许在列表的一端进行插入，另一端进行删除<br> 2、插入的一端称为队尾（rear），插入动作叫进队或入队<br> 3、进行删除的一端称为对头（front），删除动作称为出队<br> 4、队列性质：先进先出（First-in, First-out）<br> 5、双向队列：队列的两端都允许进行进队和出队操作</li>
</ol>
<ol start="3">
<li>链表<br> 链表中每个元素都是一个对象，每个对象称为一个节点，包含有数据域key和指向下一节点的指针next，通过各个节点间的相互连接，最终串联成一个链表</li>
</ol>
<ol start="4">
<li>数组<ol>
<li>所谓数组，就是相同数据类型的元素按一定顺序排列的集合</li>
<li>在Java等其他语言中并不是所有的数据都能存储到数组中，只有相同类型的数据才可以一起存储到数组中。</li>
<li>因为数组在存储数据时是按顺序存储的，存储数据的内存也是连续的，所以他的特点就是寻址读取数据比较容易，插入和删除比较困难</li>
</ol>
</li>
</ol>
<ol start="5">
<li>字典对象实现原理</li>
</ol>
<p>1、哈希表 (hash tables)<br>    1. 哈希表（也叫散列表），根据关键值对(Key-value)而直接进行访问的数据结构。<br>    2. 它通过把key和value映射到表中一个位置来访问记录，这种查询速度非常快，更新也快。<br>    3. 而这个映射函数叫做哈希函数，存放值的数组叫做哈希表。<br>    4. 通过把每个对象的关键字k作为自变量，通过一个哈希函数h(k)，将k映射到下标h(k)处，并将此对象存储在这个位置。</p>
<p>2、具体操作过程<br>    1. 数据添加：把key通过哈希函数转换成一个整型数字，然后就将该数字对数组长度进行取余，取余结果就当作数组的下标，<br>             将value存储在以该数字为下标的数组空间里。<br>    2. 数据查询：再次使用哈希函数将key转换为对应的数组下标，并定位到数组的位置获取value。</p>
<p>3、{“name”:”zhangsan”,”age”:26} 字典如何存储的呢?<br>    1. 比如字典{“name”:”zhangsan”,”age”:26}，那么他们的字典key为name、age，假如哈希函数h(“name”) = 1、h(“age”)=3,<br>    2. 那么对应字典的key就会存储在列表对应下标的位置，[None, “zhangsan”, None, 26</p>

        </div>

        
        <section class="post-tags">
            <div>
                <span>Tag(s):</span>
                <span class="tag">
                    
                    
                        <a href="/tags/%E7%AC%94%E8%AE%B0/"># 笔记</a>
                    
                        
                </span>
            </div>
            <div>
                <a href="javascript:window.history.back();">back</a>
                <span>· </span>
                <a href="/">home</a>
            </div>
        </section>
        <section class="post-nav">
            
                <a class="prev" rel="prev" href="/2020/04/11/day30/">算法</a>
            
            
            <a class="next" rel="next" href="/2020/04/09/day28/">Day28</a>
            
        </section>


    </article>
</div>

        </div>
        <footer id="footer" class="footer">
    <div class="copyright">
        <span>© 陈士方 | Powered by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/Siricee/hexo-theme-Chic" target="_blank">Chic</a></span>
    </div>
</footer>
			
    </div>
	
<iframe src="https://zhanyuzhang.github.io/lovely-cat/cat.html" frameborder="0" id="catIframe"></iframe>

</body>


<style>
#catIframe {
position: fixed;
width: 400px;
/* padding: 50px 0px; */
top: 80%;
left: 10%;
transform: translate(-68%, -50%);
}

</style>
</html>
