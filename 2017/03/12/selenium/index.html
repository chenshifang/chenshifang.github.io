<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="author" content="陈士方">





<title>Selenium | 陈士方的博客</title>



    <link rel="icon" href="/favicon.ico">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    



    <!-- scripts list from _config.yml -->
    
    <script src="/js/script.js"></script>
    
    <script src="/js/tocbot.min.js"></script>
    



    
    
        
    


	
<meta name="generator" content="Hexo 4.2.0"></head>


<body>
    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo">
				<a href="/">
				陈士方的博客
				</a>
			</div>
			
			
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/archives">目录</a>
                
                    <a class="menu-item" href="/category">分类</a>
                
                    <a class="menu-item" href="/tag">标签</a>
                
                    <a class="menu-item" href="http://chenshifang.gitee.io/chen_resume/" target="_blank" rel="noopener">关于</a>
                
                <input id="switch_default" type="checkbox" class="switch_default">
                <label for="switch_default" class="toggleBtn"></label>
            </div>

        </div>
    </nav>

    
    <nav class="navbar-mobile" id="nav-mobile">
        <div class="container">
            <div class="navbar-header">
                <div>
                    <a href="/">陈士方的博客</a><a id="mobile-toggle-theme">·&nbsp;Light</a>
                </div>
                <div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div>
            </div>
            <div class="menu" id="mobile-menu">
                
                    <a class="menu-item" href="/archives">目录</a>
                
                    <a class="menu-item" href="/category">分类</a>
                
                    <a class="menu-item" href="/tag">标签</a>
                
                    <a class="menu-item" href="http://chenshifang.gitee.io/chen_resume/" target="_blank" rel="noopener">关于</a>
                
            </div>
        </div>
    </nav>

</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if(toggleMenu.classList.contains("active")){
           toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        }else{
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>
        <div class="main">
            <div class="container">
    
    
        <div class="post-toc">
    <div class="tocbot-list">
    </div>
    <div class="tocbot-list-menu">
        <a class="tocbot-toc-expand" onclick="expand_toc()">Expand all</a>
        <a onclick="go_top()">Back to top</a>
        <a onclick="go_bottom()">Go to bottom</a>
    </div>
</div>

<script>
    document.ready(
        function () {
            tocbot.init({
                tocSelector: '.tocbot-list',
                contentSelector: '.post-content',
                headingSelector: 'h1, h2, h3, h4, h5',
                collapseDepth: 1,
                orderedList: false,
                scrollSmooth: true,
            })
        }
    )

    function expand_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 6,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "collapse_toc()");
        b.innerHTML = "Collapse all"
    }

    function collapse_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 1,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "expand_toc()");
        b.innerHTML = "Expand all"
    }

    function go_top() {
        window.scrollTo(0, 0);
    }

    function go_bottom() {
        window.scrollTo(0, document.body.scrollHeight);
    }

</script>
    

    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">Selenium</h1>
            
                <div class="post-meta">
                    
                        Author: <a itemprop="author" rel="author" href="/">陈士方</a>
                    

                    
                        <span class="post-time">
                        Date: <a href="#">三月 12, 2017&nbsp;&nbsp;16:02:18</a>
                        </span>
                    
                    
                        <span class="post-category">
                    Category:
                            
                                <a href="/categories/%E7%AC%94%E8%AE%B0/">笔记</a>
                            
                        </span>
                    
                </div>
            
        </header>

        <div class="post-content">
            <h3 id="自动化测试工具：selenium"><a href="#自动化测试工具：selenium" class="headerlink" title="自动化测试工具：selenium"></a>自动化测试工具：selenium</h3><p>Chromedriver下载地址： <a href="http://chromedriver.storage.googleapis.com/index.html" target="_blank" rel="noopener">http://chromedriver.storage.googleapis.com/index.html</a></p>
<pre><code>注意：版本要与浏览器的版本接近</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">#导入selenium</span><br><span class="line">from selenium import webdriver</span><br><span class="line"></span><br><span class="line">#创建chrome驱动实例,打开浏览器</span><br><span class="line">driver&#x3D;webdriver.Chrome()</span><br><span class="line"></span><br><span class="line">#浏览器最大化</span><br><span class="line">driver.maximize_window()</span><br><span class="line"></span><br><span class="line">#浏览器最小化</span><br><span class="line">driver.minimize_window()</span><br><span class="line"></span><br><span class="line">#获取浏览器当前窗口大小</span><br><span class="line">size&#x3D;driver.get_window_size()</span><br><span class="line"></span><br><span class="line">#设置浏览器窗口大小</span><br><span class="line">driver.set_window_size(400,400)</span><br><span class="line"></span><br><span class="line">#打开指定网页</span><br><span class="line">driver.get(&quot;http:&#x2F;&#x2F;www.so.com&quot;)</span><br><span class="line"></span><br><span class="line">#获取当前页面的链接地址</span><br><span class="line">url&#x3D;driver.current_url</span><br><span class="line">driver.get(&quot;http:&#x2F;&#x2F;baike.so.com&quot;)</span><br><span class="line"></span><br><span class="line">#后退</span><br><span class="line">driver.back()</span><br><span class="line"></span><br><span class="line">#前进</span><br><span class="line">driver.forward()</span><br><span class="line"></span><br><span class="line">#浏览器退出</span><br><span class="line">driver.close()</span><br><span class="line">driver.quit()</span><br></pre></td></tr></table></figure>


<h3 id="frame"><a href="#frame" class="headerlink" title="frame"></a>frame</h3><p>frame标签包含frameset、frame、iframe三种，frameset和普通的标签一样，不会影响正常的定位，而iframe和frame需要进行一些特殊的处理</p>
<p>例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;html lang&#x3D;&quot;en&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;FrameTest&lt;&#x2F;title&gt;</span><br><span class="line">&lt;&#x2F;head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;iframe src&#x3D;&quot;a.html&quot; id&#x3D;&quot;frame1&quot; name&#x3D;&quot;myframe&quot;&gt;&lt;&#x2F;iframe&gt;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure>

<p>用frame的index定位</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.switch_to.frame(1)</span><br></pre></td></tr></table></figure>
<pre><code>index从0开始，传入整型参数即判定为用index定位，传入str参数则判定为用id/name定位</code></pre><p>用id定位</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.switch_to.frame(&#39;frame1&#39;)</span><br></pre></td></tr></table></figure>

<p>用name定位</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.switch_to.frame(&#39;myframe&#39;)</span><br></pre></td></tr></table></figure>

<p>用WebElement对象来定位</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.switch_to.frame(driver.find_element_by_tag_name(&quot;iframe&quot;))</span><br></pre></td></tr></table></figure>

<pre><code>WebElement对象，即用find_element系列方法所取得的对象，我们可以用tag_name、xpath等来定位frame对象</code></pre><p>例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;iframe src&#x3D;&quot;myframetest.html&quot; &#x2F;&gt;</span><br></pre></td></tr></table></figure>

<p>用xpath定位，传入WebElement对象</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.switch_to.frame(driver.find_element_by_xpath(&quot;&#x2F;&#x2F;iframe[contains(@src,&#39;myframe&#39;)]&quot;))</span><br></pre></td></tr></table></figure>


<p>嵌套frame的操作<br>例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">    &lt;iframe id&#x3D;&quot;frame1&quot;&gt;</span><br><span class="line">        &lt;iframe id&#x3D;&quot;frame2&quot; &#x2F; &gt;</span><br><span class="line">    &lt;&#x2F;iframe&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure>

<p>1，从主文档切到frame2，一层层切进去</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">driver.switch_to.frame(&quot;frame1&quot;)</span><br><span class="line">driver.switch_to.frame(&quot;frame2&quot;)</span><br></pre></td></tr></table></figure>

<p>2，从frame2再切回frame1，这里selenium给我们提供了一个方法能够从子frame切回到父frame，而不用我们切回主文档再切进来。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">driver.switch_to.parent_frame()</span><br><span class="line">&#96;&#96;&#96; </span><br><span class="line"></span><br><span class="line">	有了parent_frame()这个相当于后退的方法，我们可以随意切换不同的frame，随意的跳来跳去了。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">### 元素定位</span><br><span class="line">例：</span><br></pre></td></tr></table></figure>
<input type="text" name="q" class="placeholder" id="input" suggestwidth="540px" autocomplete="off">
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">根据标签的ID属性定位</span><br></pre></td></tr></table></figure>
driver.find_element_by_id("input")
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">根据标签的name属性定位</span><br></pre></td></tr></table></figure>
driver.find_element_by_name("q")
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">根据标签的class属性定位</span><br></pre></td></tr></table></figure>
driver.find_element_by_class_name("placeholder")
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">根据标签名定位</span><br></pre></td></tr></table></figure>
driver.find_element_by_tag_name("input")
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">通过link_text定位</span><br></pre></td></tr></table></figure>
<a href="http://www.so.com/link?3D" target="_blank" rel="noopener" data-url="http://ly.so.com/?src=tab_web" data-linkid="liangyi">良医</a>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#96;&#96;&#96;</span><br><span class="line">driver.find_element_by_link_text(&quot;良医&quot;)</span><br><span class="line">driver.find_element_by_partial_link_text(&quot;医&quot;)</span><br></pre></td></tr></table></figure>

<p>例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;input type&#x3D;&quot;text&quot; name&#x3D;&quot;q&quot; class&#x3D;&quot;placeholder&quot; id&#x3D;&quot;input&quot; suggestwidth&#x3D;&quot;540px&quot; autocomplete&#x3D;&quot;off&quot;&gt;</span><br></pre></td></tr></table></figure>

<p>通过标签定位</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.find_element_by_css_selector(&quot;input&quot;)</span><br></pre></td></tr></table></figure>

<p>通过id定位</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.find_element_by_css_selector(&quot;#input&quot;)</span><br></pre></td></tr></table></figure>

<p>通过class定位</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.find_element_by_css_selector(&quot;.placeholder&quot;)</span><br></pre></td></tr></table></figure>

<p>通过属性定位</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.find_element_by_css_selector(&#39;[name&#x3D;&quot;q&quot;]&#39;)</span><br></pre></td></tr></table></figure>

<p>以上都是单一形式的定位，上面的所有形式都可以进行组合定位</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">driver.find_element_by_css_selector(&quot;input#input&quot;)</span><br><span class="line">driver.find_element_by_css_selector(&quot;#input[name&#x3D;&#39;q&#39;]&quot;)</span><br></pre></td></tr></table></figure>

<p>xpath中的逻辑运算（与或非）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.find_element_by_xpath(&quot;&#x2F;&#x2F;input[@name&#x3D;&#39;q&#39; and @ id&#x3D;&#39;input&#39;]&quot;)</span><br></pre></td></tr></table></figure>

<p>包含 contains函数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.find_element_by_xpath(&quot;&#x2F;&#x2F;input[contains(@id,&#39;input&#39;)]&quot;)</span><br></pre></td></tr></table></figure>

<p>元素文本信息text函数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.find_element_by_xpath(&quot;&#x2F;&#x2F;*[contains(text(),&#39;医&#39;)]&quot;)</span><br></pre></td></tr></table></figure>

<p>starts-with函数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.find_element_by_xpath(&quot;&#x2F;&#x2F;input[starts-with(@id,&#39;inpu&#39;)]&quot;)</span><br></pre></td></tr></table></figure>

<p>ends-with函数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.find_element_by_xpath(&quot;&#x2F;&#x2F;input[ends-with(@id,&#39;nput&#39;)]&quot;)</span><br></pre></td></tr></table></figure>


<h3 id="元素操作"><a href="#元素操作" class="headerlink" title="元素操作"></a>元素操作</h3><p>清除文本框内容</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">input_element.clear()</span><br></pre></td></tr></table></figure>
<p>点击操作</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">input_element.click()</span><br></pre></td></tr></table></figure>
<p>对文本框输入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">input_element.send_keys()</span><br></pre></td></tr></table></figure>
<p>提交表单</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">input_element.submit()</span><br></pre></td></tr></table></figure>
<p>获取元素指定属性的值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">input_element.get_attribute(&quot;name&quot;)</span><br><span class="line">input_element.get_property(&quot;name&quot;)</span><br></pre></td></tr></table></figure>
<p>获取元素的大小</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ele_size&#x3D;input_element.size</span><br></pre></td></tr></table></figure>
<p>获取该元素的子元素</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">input_element.find_element()</span><br></pre></td></tr></table></figure>
<p>判断元素是否显示</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">input_element.is_displayed()</span><br></pre></td></tr></table></figure>
<p>判断元素是否可以使用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">input_element.is_enabled()</span><br></pre></td></tr></table></figure>
<p>判断元素是否是选中状态</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">input_element.is_selected()</span><br></pre></td></tr></table></figure>
<p>查看元素的标签名</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">input_tag&#x3D;input_element.tag_name</span><br></pre></td></tr></table></figure>


<h3 id="js常用脚本"><a href="#js常用脚本" class="headerlink" title="js常用脚本"></a>js常用脚本</h3><p>执行js脚本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.execute_script(&#39;script&#39;)</span><br></pre></td></tr></table></figure>

<p>页面滑动</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">js1&#x3D;&quot;window.scrollTo(1000,1000)&quot;</span><br><span class="line">js11&#x3D;&#39;window.scrollTo(0,0)&#39;</span><br><span class="line">js12&#x3D;&#39;window,scrollTo(0,document.body.scrollHeight)&#39;（向下滚动一屏）</span><br><span class="line">driver.execute_script(&quot;arguments[0].scrollIntoView();&quot;, input_element)</span><br></pre></td></tr></table></figure>

<p>设置元素属性：例如修改时间控件，设置页面元素是否可见等,可以省去很多selenium的步骤</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">js2&#x3D;&#39;document.getElementById(&quot;XXX&quot;).setAttribute(&quot;placeholder&quot;,&quot;thisismyplaceholder&quot;)&#39;</span><br></pre></td></tr></table></figure>

<p>删除元素属性</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">js3&#x3D;&#39;document.getElementById(&quot;XXX&quot;).removeAttribute(&quot;placeholder&quot;)&#39;</span><br></pre></td></tr></table></figure>

<p>元素操作操作：click,focus，blur等</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">js4&#x3D;&#39;document.getElementById(&quot;xxx&quot;).click()&#39;</span><br></pre></td></tr></table></figure>

<p>元素定位  注意：这里需要有return</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">js5&#x3D;&#39;return document.getElementById(&quot;xxx&quot;)&#39;</span><br></pre></td></tr></table></figure>

<p>停止页面加载</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">js6&#x3D;window.stop</span><br></pre></td></tr></table></figure>


<h3 id="鼠标事件"><a href="#鼠标事件" class="headerlink" title="鼠标事件"></a>鼠标事件</h3><p>导入鼠标事件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">from selenium.webdriver.common.action_chains import ActionChains</span><br></pre></td></tr></table></figure>
<p>双击</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ActionChains(driver).double_click(&#39;target_element&#39;).perform()</span><br></pre></td></tr></table></figure>
<p>右击</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ActionChains(driver).context_click(&quot;target_element&quot;).perform()</span><br></pre></td></tr></table></figure>
<p>拖动</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ActionChains(driver).drag_and_drop(&quot;start_element&quot;,&quot;end_element&quot;).perform()</span><br></pre></td></tr></table></figure>

<p>鼠标移动到指定元素</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ActionChains(driver).move_to_element(&quot;target_element&quot;).perform()</span><br></pre></td></tr></table></figure>
<p>弹出一个alert</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.execute_script(&quot;alert(&#39;helloworld&#39;)&quot;)</span><br></pre></td></tr></table></figure>
<p>切换到alert</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">my_alert&#x3D;driver.switch_to.alert</span><br></pre></td></tr></table></figure>
<p>获取alert信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alert_info&#x3D;my_alert.text</span><br></pre></td></tr></table></figure>
<p>点击确定</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">my_alert.accept()</span><br></pre></td></tr></table></figure>
<p>点击X</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">my_alert.dismiss()</span><br></pre></td></tr></table></figure>

<p>单击鼠标左键</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">click(on_element&#x3D;None)</span><br></pre></td></tr></table></figure>
<p>点击鼠标左键，不松开</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">click_and_hold(on_element&#x3D;None)</span><br></pre></td></tr></table></figure>
<p>点击鼠标右键</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">context_click(on_element&#x3D;None)</span><br></pre></td></tr></table></figure>
<p>双击鼠标左键</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">double_click(on_element&#x3D;None)</span><br></pre></td></tr></table></figure>
<p>拖拽到某个元素然后松开</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drag_and_drop(source, target)</span><br></pre></td></tr></table></figure>
<p>拖拽到某个坐标然后松开</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drag_and_drop_by_offset(source, xoffset, yoffset)</span><br></pre></td></tr></table></figure>
<p>按下某个键盘上的键</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">key_down(value, element&#x3D;None)</span><br></pre></td></tr></table></figure>
<p>松开某个键</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">key_up(value, element&#x3D;None)</span><br></pre></td></tr></table></figure>
<p>鼠标从当前位置移动到某个坐标</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">move_by_offset(xoffset, yoffset)</span><br></pre></td></tr></table></figure>
<p>鼠标移动到某个元素</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">move_to_element(to_element)</span><br></pre></td></tr></table></figure>
<p>移动到距某个元素（左上角坐标）多少距离的位置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">move_to_element_with_offset(to_element, xoffset, yoffset)</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">perform() ——执行链中的所有动作</span><br></pre></td></tr></table></figure>
<p>在某个元素位置松开鼠标左键</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">release(on_element&#x3D;None)</span><br></pre></td></tr></table></figure>
<p>发送某个键到当前焦点的元素</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">send_keys(*keys_to_send)</span><br></pre></td></tr></table></figure>
<p>发送某个键到指定元素</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">send_keys_to_element(element, *keys_to_send)</span><br></pre></td></tr></table></figure>

<p>切换到当前被操作元素</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ele&#x3D;driver.switch_to.active_element</span><br></pre></td></tr></table></figure>

<p>切换alert、confirm、prompt框</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alert &#x3D; driver.switch_to.alert</span><br></pre></td></tr></table></figure>

<p>切换到默认页面</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.switch_to.default_content()</span><br></pre></td></tr></table></figure>

<p>获取浏览器所有句柄</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">handles&#x3D;driver.window_handles</span><br></pre></td></tr></table></figure>

<p>获取当前句柄</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">current_handle&#x3D;driver.current_window_handle</span><br><span class="line">driver.switch_to.window()</span><br></pre></td></tr></table></figure>


<h3 id="截图"><a href="#截图" class="headerlink" title="截图"></a>截图</h3><p>截取当前窗口，并指定截图图片的保存位置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.get_screenshot_as_file(&quot;D:\selenium_img.png&quot;)</span><br></pre></td></tr></table></figure>

<p>全屏截图</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.save_screenshot(&quot;img.png&quot;)</span><br></pre></td></tr></table></figure>

<p>获取屏幕截图，以二进制格式保存</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.get_screenshot_as_png()</span><br></pre></td></tr></table></figure>

<p>获取屏幕截图，以base64的编码格式保存</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.get_screenshot_as_base64()</span><br></pre></td></tr></table></figure>







        </div>

        
        <section class="post-tags">
            <div>
                <span>Tag(s):</span>
                <span class="tag">
                    
                    
                        <a href="/tags/selenium/"># selenium</a>
                    
                        
                </span>
            </div>
            <div>
                <a href="javascript:window.history.back();">back</a>
                <span>· </span>
                <a href="/">home</a>
            </div>
        </section>
        <section class="post-nav">
            
                <a class="prev" rel="prev" href="/2017/03/18/%E7%AC%AC%E4%B8%89%E6%96%B9%E7%99%BB%E5%BD%95-%E9%92%89%E9%92%89/">第三方登录-钉钉</a>
            
            
            <a class="next" rel="next" href="/2017/03/11/docker%E5%91%BD%E4%BB%A4/">Docker简介、命令</a>
            
        </section>


    </article>
</div>

        </div>
        <footer id="footer" class="footer">
    <div class="copyright">
        <span>© 陈士方 | Powered by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/Siricee/hexo-theme-Chic" target="_blank">Chic</a></span>
    </div>
</footer>
			
    </div>
	
<iframe src="https://zhanyuzhang.github.io/lovely-cat/cat.html" frameborder="0" id="catIframe"></iframe>

</body>


<style>
#catIframe {
position: fixed;
width: 400px;
/* padding: 50px 0px; */
top: 80%;
left: 10%;
transform: translate(-68%, -50%);
}

</style>
</html>
